var t="local",e="external",s=t=>t.toLowerCase(),r=(t,e)=>{var s=t.indexOf(e);return[t[O](0,s),t[O](s+e[T])]},i=(t,e)=>c(t)instanceof e,n=t=>(e,s)=>{var r;if(!t.t?.(e,s))return(r=i(s,String)?t.i?.(e,s):t.h?.(e,s))!==u?r:t.u?t.u(e,s):i(r=e[s],Function)?r.bind(e):r};class h extends Function{constructor(t){return c.setPrototypeOf(t,new.target[R])}}var u,a=!!globalThis.window,o=t=>"http://localhost:"+(t??9801),_=a?location.origin:o(process.env.PORT),l=/^\w+:\/\/localhost/.test(_)?t:e,c=Object,g=Proxy,f=c.assign,p="\r\n",d="Get_Supported_Events",v="Has_Event",w=s(d),y=s(v),m="get_simple_caller_of_event",b="trivial_clone",S="default_info",x="default_security_level",E="sstp_version_table",O="substring",T="length",k="available",N="split",C="entries",F="costom_text_send",P="forEach",$="get_caller_of_method",q="unknown_lines",j="get_caller_of_event",G="sendername",I="proxy",M="then",R="prototype",U="SEND",H="get_fmo_infos",J="get_passthrough",X="flat_map",A="RequestHeader",D="check_event",V="from_string",Y="",B="X-SSTP-PassThru-";class K{get keys(){return c.keys(this)}get values(){return c.values(this)}get[C](){return c[C](this)}get[T](){return this.keys[T]}[P](t){this[C][P](([e,s])=>{this[e]=t(s,e)??s})}get[b](){return f(L(),this)}[X](t){let e=[];return this[C].map(([s,r])=>e.push(...i(r,K)?r[X](t.bind(t,s)):[t(s,r)])),e}map(t){return this[C].map(([e,s])=>t(s,e))}push(t){return t[P](t=>t?this[t[0]]=t[1]:u),this}}var L=()=>new K;class Q extends K{#t;#e;constructor(t,e,s={}){super(),this.#t=Y+t,s[T]&&(this.#e=s),f(this,e)}get[q](){return this.#e||[]}get head(){return this.#t}toString(){return[this.#t,...this[q],...this[C].map(([t,e])=>t+": "+e),Y,Y].join(p)}to_string(){return Y+this}toJSON(){return{head:this.#t,[q]:this.#e,body:this[b]}}get status_code(){return+this.#t[N](" ").find(t=>{return(t=+t)==t})}}class W extends Q{constructor(t,e,s={}){return super(t,e,s),new g(this,{get:n({i:(t,e)=>B+e in t&&!c.getOwnPropertyNames(W[R]).includes(e)?t[J](e):u})})}static[V](t){let e,[s,...i]=t[N](p),n={},h=[];i[T]-=2;for(let t of i){let[s,i]=r(t,": ");/^\w[^\s]*$/.test(s)?n[e=s]=i:e?n[e]+=p+t:h.push(t)}return new W(s,n,h)}[J](t){return this[B+t]}#s;get passthroughs(){return this.#s??=L().push(this.map((t,e)=>e.startsWith(B)?[e.slice(16),t]:u))}get raw(){return this}}class Z extends Q{constructor(t){var[t,...s]=t[N](p);super(t,{});for(let t of s)if(t){let[e,s]=r(t,""),[i,n]=r(e,".");(this[i]||=L())[n]=s}}get_uuid_by(t,e){return this.uuids.find(s=>this[s][t]==e)}get_list_of(t){return this.uuids.map(e=>this[e][t])}get uuids(){return this.keys}get[k](){return!!this[T]}toString(){return[this.head,Y,...this[X]((t,e,s)=>t+"."+e+""+s),Y,Y].join(p)}toJSON(){return{head:this.head,fmo_infos:this[b]}}}class tt extends h{#r;#i;#n;#h;#u;constructor(t){super((t,e=this[x])=>this[D](t,e)),this.#r=t,this[x]=t[x]}async[D](t,e=this[x]){return this.#n?this.#h[e].includes(t):!!this.#i&&(this.#u[e][t]??=await this.#r[y](t))}get[k](){return this.#i}get fast_query_available(){return this.#n}reset(){return this.clear(),this.init()}async init(){var t=this.#r;return this.#i=await t[y](v),this.#n=this.#i&&await t[y](d),this.#n&&(this.#h=await t[w]()),this}clear(){this.#i=this.#n=!1,this.#u={[t]:{},[e]:{}}}}class et{#a;constructor(t,e){return this[A]={Origin:_},this[S]={Charset:"UTF-8"},this.host=e,this[G]=t,this[E]={[U]:1.4,NOTIFY:1.1,COMMUNICATE:1.1,EXECUTE:1.2,GIVE:1.1},this[x]=l,this[I]=new g(this,{get:n({i:(t,e)=>i(t[E][e],Number)?t[$](e):/^On/.test(e)?t[m]((t=>"_"==t[2]?t[O](3):t)(e)):u})})}set host(t){this.#a=t||o()+"/api/sstp/v1"}get host(){return this.#a}set[G](t){this[S].Sender=t||"jsstp-client"}get[G](){return this[S].Sender}async row_send(t){t=await fetch(this.#a,{method:"POST",headers:this[A],body:Y+t});if(200!=t.status)throw t.status;return t.text()}[F](t,e){return this.row_send(new W(t,{...this[S],...e}))}costom_send(t,e){return this[F](t,e)[M](t=>W[V](t))}[$](t){let e=t+" SSTP/"+this[E][t];return f(t=>this.costom_send(e,t),{get_raw:t=>this[F](e,t)})}#o(t,e,s,r){return new g(s,{get:(s,i)=>i in s?s[i]:this[r](t+"."+i,e)})}[j](t,e=U){return this.#o(t,e,s=>this[I][e](f({Event:t},s)),j)}[m](t,e=U){return this.#o(t,e,(...s)=>{let r=0,i={};return s[P](t=>i["Reference"+r++]=t),this[j](t,e)(i)},m)}get event(){return new g({},{get:(t,e)=>this[m](e)})}[y](t,e=this[x]){return this.event[v](t,e)[M](({Result:t})=>1==t)}[w](){return this.event[d]()[M](({[t]:s,[e]:r})=>({[t]:(s||Y)[N](","),[e]:(r||Y)[N](",")}))}[H](){return this[I].EXECUTE.get_raw({Command:"GetFMO"})[M](t=>new Z(t))}[k](){return this[H]()[M](t=>t[k],()=>!1)}[M](t,e){return this[k]()[M](s=>s?t(this):e(),e)}new_event_queryer(){return new tt(this).init()}}f(et[R],{type:et,base_sstp_info_t:Q,sstp_info_t:W,fmo_info_t:Z,ghost_events_queryer_t:tt});a=new et;export{Q as base_sstp_info_t,a as default,Z as fmo_info_t,tt as ghost_events_queryer_t,a as jsstp,et as jsstp_t,W as sstp_info_t}
