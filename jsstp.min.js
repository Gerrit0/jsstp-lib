class sstp_info_t{#t;#i;constructor(t,s,e){this.set_head(t),this.#i=e||[],Object.assign(this,s)}static from_string(t){var e,n,r,[t,...h]=t.split("\r\n"),a={},_=[],o=[": ",""];for(e of h)if(e){let t,s;for(var u of o)if(~(s=e.indexOf(u))){t=u;break}t?([n,r]=[e.slice(0,s),e.slice(s+t.length)],a[n]=r):_.push(h[i])}return new sstp_info_t(t,a,_)}set_head(t){this.#t=t||"NOTIFY SSTP/1.1"}get_unknown_lines(){return this.#i}get_head(){return this.#t}toString(){let t=this.#t+"\r\n";for(var s in this)t+=`${s}: ${this[s]}\r\n`;return t+"\r\n"}to_string(){return this.toString()}return_code(){for(var t in this.#t.split(" "))if(!isNaN(t))return parseInt(t);return-1}get_passthrough(t){return this["X-SSTP-PassThru-"+t]}}class sstp_fmo_info_t{constructor(t={}){for(var s in t){var e=s.split("."),i=e[0],e=e[1];this[i]||(this[i]={}),this[i][e]=t[s]}}get_uuid_by(t,s){for(var e in this)if(this[e][t]==s)return e;return null}get_list_of(t){var s,e=[];for(s in this)e.push(this[s][t]);return e}keys(){return Object.keys(this)}length(){return this.keys().length}available(){return!!this.length()}}class ghost_events_queryer_t{#h;#_;#o;#u;#l;constructor(t=jsstp){this.#h=t}async check_event(t,s="local"){var e;return this.#o?this.#u[s].includes(t):!!this.#_&&(null!=(e=this.#l[s][t])?e:(e=await this.#h.has_event(t),this.#l[s][t]=e))}available(){return this.#_}get_supported_events_available(){return this.#o}async reset(){return this.clear(),this.#_=await this.#h.has_event("Has_Event"),this.#o=await this.#h.has_event("Get_Supported_Events"),this.#o&&(this.#u=await this.#h.get_supported_events()),this}async init(){return this.reset()}clear(){this.#_=!1,this.#o=!1,this.#u=null,this.#l={local:{},external:{}}}}class jsstp_t{#p;#v;#g;constructor(t,s){this.#p={},this.set_host(s),this.set_RequestHeader("Content-Type","text/plain"),this.set_RequestHeader("Origin",window.location.origin),this.#v={Charset:"UTF-8"},this.set_sendername(t);var e,i={SEND:"1.4",NOTIFY:"1.1",COMMUNICATE:"1.1",EXECUTE:"1.2",GIVE:"1.1"};for(e in i)this[e]=this.costom_send.bind(this,e+" SSTP/"+i[e])}static#j(t,s,e){null==e||""==e?delete t[s]:t[s]=e}set_RequestHeader(t,s){jsstp_t.#j(this.#p,t,s)}reset_default_info(t){this.#v=t}set_default_info(t,s){jsstp_t.#j(this.#v,t,s)}set_host(t){this.#g=t||"http://localhost:9801/api/sstp/v1"}set_sendername(t){this.#v.Sender=t||"jsstp-client"}costom_send(t,s,e){t=new sstp_info_t(t,{...this.#v,...s});const i={method:"POST",headers:this.#p,body:""+t};s=(s,e)=>{fetch(this.#g,i).then(function(t){200!=t.status?e(t.status):t.text().then(t=>s(sstp_info_t.from_string(t)))})};if(!e)return new Promise(s);s(e,function(){})}by_type(type){return eval("this."+type).bind(this)}async has_event(t,s="external"){t=(await this.SEND({Event:"Has_Event",Reference0:t,Reference1:s})).get_passthrough("Result");return!!t&&"0"!=t}async get_supported_events(){var t=await this.SEND({Event:"Get_Supported_Events"}),s=t.get_passthrough("local"),t=t.get_passthrough("external");return{local:(s||"").split(","),external:(t||"").split(",")}}async get_fmo_infos(){let t={};try{t=await this.EXECUTE({Command:"GetFMO"})}catch(t){}return new sstp_fmo_info_t(t)}async available(){return(await this.get_fmo_infos()).available()}async new_event_queryer(){return new ghost_events_queryer_t(this).init()}}var jsstp=new jsstp_t,jsttp=jsstp,jsttp_t=jsstp_t,sttp_info_t=sstp_info_t,sttp_fmo_info_t=sstp_fmo_info_t;