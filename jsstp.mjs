export var jsstp=(()=>{let s="Has_Event",r="Get_Supported_Events",n=Object.assign,o="\r\n",i="local",h="external",a="get_passthrough",u=(t,e)=>{var s=t.indexOf(e);return[t.substring(0,s),t.substring(s+e.length)]};class _{#t;#i;constructor(t,e,s){this.#t=""+t,this.#i=s||[],n(this,e)}static from_string(t){var e,[t,...s]=t.split(o),r={},n=[];let i;s.length-=2;for(e of s){var[h,a]=u(e,": ");/^\w[^\s]*$/.test(h)?r[i=h]=a:i?r[i]+=o+e:n.push(e)}return new _(t,r,n)}get unknown_lines(){return this.#i}get head(){return this.#t}toString(){var t,e=[this.#t,...this.#i];for(t in this)e.push(t+": "+this[t]);return e.join(o)+o+o}to_string(){return this.toString()}toJSON(){var t={head:this.#t,unknown_lines:this.#i,body:n({},this)};return t.unknown_lines.length||delete t.unknown_lines,t}get return_code(){for(var t in this.#t.split(" "))if(!isNaN(t))return parseInt(t)}get_passthrough(t){return this["X-SSTP-PassThru-"+t]}}class e{constructor(t){if(t)for(var e of t.unknown_lines){var s,r;e&&([e,s]=u(e,""),[e,r]=u(e,"."),this[e]||={},this[e][r]=s)}}get_uuid_by(t,e){for(var s in this)if(this[s][t]==e)return s}get_list_of(t){var e,s=[];for(e in this)s.push(this[e][t]);return s}get uuids(){return Object.keys(this)}get keys(){return this.uuids}get length(){return this.keys.length}get available(){return!!this.length}}class t{#h;#o;#u;#_;#l;constructor(t=jsstp){this.#h=t}async check_event(t,e=i){var s;return this.#u?this.#_[e].includes(t):!!this.#o&&(null!=(s=this.#l[e][t])?s:(s=await this.#h.has_event(t),this.#l[e][t]=s))}get available(){return this.#o}get supported_events_available(){return this.#u}async reset(){this.clear();var t=this.#h;return this.#o=await t.has_event(s),this.#u=await t.has_event(r),this.#u&&(this.#_=await t.get_supported_events()),this}async init(){return this.reset()}clear(){this.#o=this.#u=!1,this.#l={local:{},external:{}}}}class l{#v;RequestHeader;default_info;constructor(t,e){this.RequestHeader={"Content-Type":"text/plain",Origin:window.location.origin},this.default_info={Charset:"UTF-8"},this.host=e,this.sendername=t}set host(t){this.#v=t||"http://localhost:9801/api/sstp/v1"}get host(){return this.#v}set sendername(t){this.default_info.Sender=t||"jsstp-client"}get sendername(){return this.default_info.Sender}costom_send(t,r,e){var s=(e,s)=>fetch(this.#v,{method:"POST",headers:this.RequestHeader,body:""+new _(t,{...this.default_info,...r})}).then(t=>200!=t.status?s(t.status):t.text().then(t=>e(_.from_string(t)))).catch(s);return e?s(e,()=>{}):new Promise(s)}async has_event(t,e=h){t=(await this.SEND({Event:s,Reference0:t,Reference1:e}))[a]("Result");return!!t&&"0"!=t}async get_supported_events(){var t=await this.SEND({Event:r}),e=t[a](i),t=t[a](h);return{local:(e||"").split(","),external:(t||"").split(",")}}async get_fmo_infos(){return this.EXECUTE({Command:"GetFMO"}).then(t=>new e(t)).catch(()=>new e)}async available(){return(await this.get_fmo_infos()).available}async new_event_queryer(){return new t(this).init()}}let c={SEND:1.4,NOTIFY:1.1,COMMUNICATE:1.1,EXECUTE:1.2,GIVE:1.1};var v=l.prototype;for(let s in c)v[s]=function(t,e){return this.costom_send(s+" SSTP/"+c[s],t,e)};return n(v,{type:l,sstp_info_t:_,fmo_info_t:e,ghost_events_queryer_t:t}),new l})();